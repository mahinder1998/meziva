{"version":3,"file":"business-platform.js","sourceRoot":"","sources":["../../../../src/public/node/api/business-platform.ts"],"names":[],"mappings":"AAAA,OAAO,EAAsD,cAAc,EAAE,iBAAiB,EAAC,MAAM,cAAc,CAAA;AACnH,OAAO,EAAC,kBAAkB,EAAC,MAAM,eAAe,CAAA;AAChD,OAAO,EAAC,oBAAoB,EAAC,MAAM,oBAAoB,CAAA;AAIvD;;;;GAIG;AACH,KAAK,UAAU,YAAY,CAAC,KAAa;IACvC,MAAM,GAAG,GAAG,kBAAkB,CAAA;IAC9B,MAAM,IAAI,GAAG,MAAM,oBAAoB,EAAE,CAAA;IACzC,MAAM,GAAG,GAAG,WAAW,IAAI,mCAAmC,CAAA;IAC9D,OAAO;QACL,KAAK;QACL,GAAG;QACH,GAAG;QACH,eAAe,EAAE,EAAC,UAAU,EAAE,kBAAkB,EAAC;KAClD,CAAA;AACH,CAAC;AAED;;;;;;;;GAQG;AACH,MAAM,CAAC,KAAK,UAAU,uBAAuB,CAC3C,KAAa,EACb,KAAa,EACb,SAA4B,EAC5B,YAA2B;IAE3B,OAAO,cAAc,CAAI;QACvB,GAAG,CAAC,MAAM,YAAY,CAAC,KAAK,CAAC,CAAC;QAC9B,KAAK;QACL,SAAS;QACT,YAAY;KACb,CAAC,CAAA;AACJ,CAAC;AAgBD;;;;;GAKG;AACH,MAAM,CAAC,KAAK,UAAU,0BAA0B,CAC9C,OAA4D;IAE5D,OAAO,iBAAiB,CAAsB;QAC5C,GAAG,CAAC,MAAM,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACtC,KAAK,EAAE,OAAO,CAAC,KAAK;QACpB,SAAS,EAAE,OAAO,CAAC,SAAS;QAC5B,YAAY,EAAE,OAAO,CAAC,YAAY;QAClC,mBAAmB,EAAE,OAAO,CAAC,mBAAmB;KACjD,CAAC,CAAA;AACJ,CAAC;AAED;;;;;GAKG;AACH,KAAK,UAAU,yBAAyB,CAAC,KAAa,EAAE,cAAsB;IAC5E,MAAM,GAAG,GAAG,kBAAkB,CAAA;IAC9B,MAAM,IAAI,GAAG,MAAM,oBAAoB,EAAE,CAAA;IACzC,MAAM,GAAG,GAAG,WAAW,IAAI,4CAA4C,cAAc,UAAU,CAAA;IAC/F,OAAO;QACL,KAAK;QACL,GAAG;QACH,GAAG;QACH,eAAe,EAAE,EAAC,UAAU,EAAE,kBAAkB,EAAC;KAClD,CAAA;AACH,CAAC;AAUD;;;;;GAKG;AACH,MAAM,CAAC,KAAK,UAAU,oCAAoC,CACxD,OAA4D;IAE5D,OAAO,cAAc,CAAI;QACvB,KAAK,EAAE,OAAO,CAAC,KAAK;QACpB,GAAG,CAAC,MAAM,yBAAyB,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,cAAc,CAAC,CAAC;QAC3E,SAAS,EAAE,OAAO,CAAC,SAAS;QAC5B,mBAAmB,EAAE,OAAO,CAAC,mBAAmB;KACjD,CAAC,CAAA;AACJ,CAAC;AAOD;;;;;GAKG;AACH,MAAM,CAAC,KAAK,UAAU,uCAAuC,CAC3D,OAAyE;IAEzE,OAAO,iBAAiB,CAAsB;QAC5C,KAAK,EAAE,OAAO,CAAC,KAAK;QACpB,GAAG,CAAC,MAAM,yBAAyB,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,cAAc,CAAC,CAAC;QAC3E,SAAS,EAAE,OAAO,CAAC,SAAS;QAC5B,mBAAmB,EAAE,OAAO,CAAC,mBAAmB;KACjD,CAAC,CAAA;AACJ,CAAC","sourcesContent":["import {CacheOptions, GraphQLVariables, UnauthorizedHandler, graphqlRequest, graphqlRequestDoc} from './graphql.js'\nimport {handleDeprecations} from './partners.js'\nimport {businessPlatformFqdn} from '../context/fqdn.js'\nimport {TypedDocumentNode} from '@graphql-typed-document-node/core'\nimport {Variables} from 'graphql-request'\n\n/**\n * Sets up the request to the Business Platform Destinations API.\n *\n * @param token - Business Platform token.\n */\nasync function setupRequest(token: string) {\n  const api = 'BusinessPlatform'\n  const fqdn = await businessPlatformFqdn()\n  const url = `https://${fqdn}/destinations/api/2020-07/graphql`\n  return {\n    token,\n    api,\n    url,\n    responseOptions: {onResponse: handleDeprecations},\n  }\n}\n\n/**\n * Executes a GraphQL query against the Business Platform Destinations API.\n *\n * @param query - GraphQL query to execute.\n * @param token - Business Platform token.\n * @param variables - GraphQL variables to pass to the query.\n * @param cacheOptions - Cache options for the request. If not present, the request will not be cached.\n * @returns The response of the query of generic type <T>.\n */\nexport async function businessPlatformRequest<T>(\n  query: string,\n  token: string,\n  variables?: GraphQLVariables,\n  cacheOptions?: CacheOptions,\n): Promise<T> {\n  return graphqlRequest<T>({\n    ...(await setupRequest(token)),\n    query,\n    variables,\n    cacheOptions,\n  })\n}\n\n/**\n * @param query - GraphQL query to execute.\n * @param token - Business Platform token.\n * @param variables - GraphQL variables to pass to the query.\n * @param cacheOptions - Cache options for the request. If not present, the request will not be cached.\n */\nexport interface BusinessPlatformRequestOptions<TResult, TVariables extends Variables> {\n  query: TypedDocumentNode<TResult, TVariables>\n  token: string\n  variables?: TVariables\n  cacheOptions?: CacheOptions\n  unauthorizedHandler: UnauthorizedHandler\n}\n\n/**\n * Executes a GraphQL query against the Business Platform Destinations API. Uses typed documents.\n *\n * @param options - The options for the request.\n * @returns The response of the query of generic type <TResult>.\n */\nexport async function businessPlatformRequestDoc<TResult, TVariables extends Variables>(\n  options: BusinessPlatformRequestOptions<TResult, TVariables>,\n): Promise<TResult> {\n  return graphqlRequestDoc<TResult, TVariables>({\n    ...(await setupRequest(options.token)),\n    query: options.query,\n    variables: options.variables,\n    cacheOptions: options.cacheOptions,\n    unauthorizedHandler: options.unauthorizedHandler,\n  })\n}\n\n/**\n * Sets up the request to the Business Platform Organizations API.\n *\n * @param token - Business Platform token.\n * @param organizationId - Organization ID as a numeric (non-GID) value.\n */\nasync function setupOrganizationsRequest(token: string, organizationId: string) {\n  const api = 'BusinessPlatform'\n  const fqdn = await businessPlatformFqdn()\n  const url = `https://${fqdn}/organizations/api/unstable/organization/${organizationId}/graphql`\n  return {\n    token,\n    api,\n    url,\n    responseOptions: {onResponse: handleDeprecations},\n  }\n}\n\nexport interface BusinessPlatformOrganizationsRequestNonTypedOptions {\n  query: string\n  token: string\n  organizationId: string\n  unauthorizedHandler: UnauthorizedHandler\n  variables?: GraphQLVariables\n}\n\n/**\n * Executes a GraphQL query against the Business Platform Organizations API.\n *\n * @param options - The options for the request.\n * @returns The response of the query of generic type <T>.\n */\nexport async function businessPlatformOrganizationsRequest<T>(\n  options: BusinessPlatformOrganizationsRequestNonTypedOptions,\n): Promise<T> {\n  return graphqlRequest<T>({\n    query: options.query,\n    ...(await setupOrganizationsRequest(options.token, options.organizationId)),\n    variables: options.variables,\n    unauthorizedHandler: options.unauthorizedHandler,\n  })\n}\n\nexport interface BusinessPlatformOrganizationsRequestOptions<TResult, TVariables extends Variables>\n  extends BusinessPlatformRequestOptions<TResult, TVariables> {\n  organizationId: string\n}\n\n/**\n * Executes a GraphQL query against the Business Platform Organizations API. Uses typed documents.\n *\n * @param options - The options for the request.\n * @returns The response of the query of generic type <T>.\n */\nexport async function businessPlatformOrganizationsRequestDoc<TResult, TVariables extends Variables>(\n  options: BusinessPlatformOrganizationsRequestOptions<TResult, TVariables>,\n): Promise<TResult> {\n  return graphqlRequestDoc<TResult, TVariables>({\n    query: options.query,\n    ...(await setupOrganizationsRequest(options.token, options.organizationId)),\n    variables: options.variables,\n    unauthorizedHandler: options.unauthorizedHandler,\n  })\n}\n"]}