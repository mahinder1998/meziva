{"version":3,"file":"LoadingBar.test.js","sourceRoot":"","sources":["../../../../../src/private/node/ui/components/LoadingBar.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import {LoadingBar} from './LoadingBar.js'\nimport {render} from '../../testing/ui.js'\nimport {shouldDisplayColors, unstyled} from '../../../../public/node/output.js'\nimport useLayout from '../hooks/use-layout.js'\nimport React from 'react'\nimport {beforeEach, describe, expect, test, vi} from 'vitest'\n\nvi.mock('../hooks/use-layout.js')\nvi.mock('../../../../public/node/output.js', async () => {\n  const original: any = await vi.importActual('../../../../public/node/output.js')\n  return {\n    ...original,\n    shouldDisplayColors: vi.fn(),\n  }\n})\n\nbeforeEach(() => {\n  // Default terminal width\n  vi.mocked(useLayout).mockReturnValue({\n    twoThirds: 53,\n    oneThird: 27,\n    fullWidth: 80,\n  })\n  vi.mocked(shouldDisplayColors).mockReturnValue(true)\n})\n\ndescribe('LoadingBar', () => {\n  test('renders loading bar with default colored characters', async () => {\n    // Given\n    const title = 'Loading content'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀\n      Loading content ...\"\n    `)\n  })\n\n  test('renders loading bar with hill pattern when noColor prop is true', async () => {\n    // Given\n    const title = 'Processing files'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} noColor />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅▄▄▃▃▂▂▁▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅\n      Processing files ...\"\n    `)\n  })\n\n  test('renders loading bar with hill pattern when shouldDisplayColors returns false', async () => {\n    // Given\n    vi.mocked(shouldDisplayColors).mockReturnValue(false)\n    const title = 'Downloading packages'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅▄▄▃▃▂▂▁▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅\n      Downloading packages ...\"\n    `)\n  })\n\n  test('handles narrow terminal width correctly', async () => {\n    // Given\n    vi.mocked(useLayout).mockReturnValue({\n      twoThirds: 20,\n      oneThird: 10,\n      fullWidth: 30,\n    })\n    const title = 'Building app'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀\n      Building app ...\"\n    `)\n  })\n\n  test('handles narrow terminal width correctly in no-color mode', async () => {\n    // Given\n    vi.mocked(useLayout).mockReturnValue({\n      twoThirds: 15,\n      oneThird: 8,\n      fullWidth: 23,\n    })\n    const title = 'Installing'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} noColor />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇\n      Installing ...\"\n    `)\n  })\n\n  test('handles very narrow terminal width in no-color mode', async () => {\n    // Given\n    vi.mocked(useLayout).mockReturnValue({\n      twoThirds: 5,\n      oneThird: 3,\n      fullWidth: 8,\n    })\n    const title = 'Wait'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} noColor />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▁▁▁▂▂\n      Wait ...\"\n    `)\n  })\n\n  test('handles wide terminal width correctly', async () => {\n    // Given\n    vi.mocked(useLayout).mockReturnValue({\n      twoThirds: 100,\n      oneThird: 50,\n      fullWidth: 150,\n    })\n    const title = 'Synchronizing data'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀\n      Synchronizing data ...\"\n    `)\n  })\n\n  test('handles wide terminal width correctly in no-color mode with pattern repetition', async () => {\n    // Given\n    vi.mocked(useLayout).mockReturnValue({\n      twoThirds: 90,\n      oneThird: 45,\n      fullWidth: 135,\n    })\n    const title = 'Analyzing dependencies'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} noColor />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅▄▄▃▃▂▂▁▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅▄▄▃▃▂▂▁▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅▄▄▃▃▂▂▁\n      Analyzing dependencies ...\"\n    `)\n  })\n\n  test('renders correctly with empty title', async () => {\n    // Given\n    const title = ''\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀\n       ...\"\n    `)\n  })\n\n  test('noColor prop overrides shouldDisplayColors when both would show colors', async () => {\n    // Given\n    vi.mocked(shouldDisplayColors).mockReturnValue(true)\n    const title = 'Testing override'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} noColor />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\n      \"▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅▄▄▃▃▂▂▁▁▁▁▂▂▃▃▄▄▅▅▆▆▇▇██▇▇▆▆▅▅\n      Testing override ...\"\n    `)\n  })\n\n  test('renders consistently with same props', async () => {\n    // Given\n    const title = 'Consistent test'\n    const props = {title, noColor: false}\n\n    // When\n    const {lastFrame: frame1} = render(<LoadingBar {...props} />)\n    const {lastFrame: frame2} = render(<LoadingBar {...props} />)\n\n    // Then\n    expect(frame1()).toBe(frame2())\n  })\n\n  test('hides progress bar when noProgressBar is true', async () => {\n    // Given\n    vi.mocked(shouldDisplayColors).mockReturnValue(true)\n    const title = 'task 1'\n\n    // When\n    const {lastFrame} = render(<LoadingBar title={title} noProgressBar />)\n\n    // Then\n    expect(unstyled(lastFrame()!)).toMatchInlineSnapshot(`\"task 1 ...\"`)\n  })\n})\n"]}