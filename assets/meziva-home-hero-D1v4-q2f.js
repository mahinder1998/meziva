class h extends HTMLElement{constructor(){super(),this.track=this.querySelector("[data-slider-track]"),this.prev=this.querySelector("[data-slider-prev]"),this.next=this.querySelector("[data-slider-next]"),this.dotsWrap=this.querySelector("[data-slider-dots]"),this.showArrows=this.dataset.showArrows!=="false",this.showDots=this.dataset.showDots!=="false",this.autoplay=this.dataset.autoplay==="true",this.intervalSec=Math.max(2,parseInt(this.dataset.interval||"4",10)||4),this.index=0,this.step=1,this.timer=null,this.isInteracting=!1,this.onScroll=this.onScroll.bind(this),this.onResize=this.onResize.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this)}connectedCallback(){var t,s,i,n;this.track&&(this.showArrows||((t=this.prev)==null||t.classList.add("sw-hidden"),(s=this.next)==null||s.classList.add("sw-hidden")),(i=this.prev)==null||i.addEventListener("click",()=>this.goTo(this.index-1)),(n=this.next)==null||n.addEventListener("click",()=>this.goTo(this.index+1)),this.track.addEventListener("scroll",this.onScroll,{passive:!0}),window.addEventListener("resize",this.onResize,{passive:!0}),this.track.addEventListener("pointerdown",this.onPointerDown,{passive:!0}),window.addEventListener("pointerup",this.onPointerUp,{passive:!0}),requestAnimationFrame(()=>this.rebuild()),window.addEventListener("load",()=>this.rebuild(),{once:!0}),this.startAutoplay())}disconnectedCallback(){var t,s;this.stopAutoplay(),(t=this.track)==null||t.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),(s=this.track)==null||s.removeEventListener("pointerdown",this.onPointerDown),window.removeEventListener("pointerup",this.onPointerUp)}slides(){return this.track?[...this.track.querySelectorAll("[data-slider-slide]")]:[]}slidesCount(){return this.slides().length}computeStep(){if(!this.track)return;const t=this.track.querySelector("[data-slider-slide]"),s=(t==null?void 0:t.getBoundingClientRect().width)||0,i=this.track.getBoundingClientRect().width||1;this.step=s>0?s:i}buildDots(){if(!this.showDots||!this.dotsWrap)return;const t=this.slidesCount();this.dotsWrap.innerHTML="";for(let s=0;s<t;s++){const i=document.createElement("button");i.type="button",i.setAttribute("aria-label",`Go to slide ${s+1}`),i.className="sw-h-2.5 sw-w-2.5 sw-rounded-full sw-border sw-border-black/10 sw-bg-white/80",i.addEventListener("click",()=>this.goTo(s)),this.dotsWrap.appendChild(i)}this.updateDots()}updateDots(){this.dotsWrap&&[...this.dotsWrap.children].forEach((t,s)=>{t.classList.toggle("sw-bg-black/70",s===this.index),t.classList.toggle("sw-bg-white/80",s!==this.index)})}goTo(t,s=!0){if(!this.track)return;this.computeStep();const i=Math.max(0,this.slidesCount()-1);this.index=Math.max(0,Math.min(t,i)),this.track.scrollTo({left:this.step*this.index,behavior:s?"smooth":"auto"}),this.updateDots()}onScroll(){if(!this.track)return;this.computeStep();const t=Math.round(this.track.scrollLeft/(this.step||1));t!==this.index&&(this.index=t,this.updateDots())}onResize(){this.computeStep(),this.goTo(this.index,!1)}rebuild(){this.computeStep(),this.buildDots(),this.goTo(this.index,!1),this.updateDots()}onPointerDown(){this.isInteracting=!0,this.stopAutoplay()}onPointerUp(){this.isInteracting=!1,this.startAutoplay()}startAutoplay(){if(!this.autoplay||this.timer||this.isInteracting)return;const t=this.slidesCount();t<=1||(this.timer=window.setInterval(()=>{const s=this.index+1>=t?0:this.index+1;this.goTo(s)},this.intervalSec*1e3))}stopAutoplay(){this.timer&&(window.clearInterval(this.timer),this.timer=null)}}customElements.define("meziva-simple-slider",h);class c extends HTMLElement{constructor(){super(),this.variantIdEl=this.querySelector("[data-role='variant-id']"),this.qtyEl=this.querySelector("[data-role='qty']"),this.minus=this.querySelector("[data-role='qty-minus']"),this.plus=this.querySelector("[data-role='qty-plus']"),this.form=this.querySelector("[data-role='atc-form']"),this.btn=this.querySelector("[data-role='atc-btn']"),this.status=this.querySelector("[data-role='status']"),this.priceEl=this.querySelector("[data-role='price']"),this.mountStickyToBody(),this.sticky=this.querySelector("[data-role='sticky-atc']"),this.stickyBtn=this.querySelector("[data-role='sticky-atc-btn']"),this.stickyQtyEl=this.querySelector("[data-role='sticky-qty']"),this.stickyMinus=this.querySelector("[data-role='sticky-qty-minus']"),this.stickyPlus=this.querySelector("[data-role='sticky-qty-plus']"),this.stickyPrice=this.querySelector("[data-role='sticky-price']"),this.cartAddUrl=this.dataset.cartAddUrl||"/cart/add.js",this.checkoutUrl=this.dataset.checkoutUrl||"/checkout",this.redirect=this.dataset.redirect||"checkout",this.stickyEnabled=this.dataset.stickyEnabled!=="false",this.onSubmit=this.onSubmit.bind(this)}mountStickyToBody(){this.sticky&&this.sticky.dataset.mounted!=="true"&&(this.sticky.dataset.mounted="true",document.body.appendChild(this.sticky))}connectedCallback(){var t,s,i,n,e,r;(t=this.minus)==null||t.addEventListener("click",()=>this.setQty(this.getQty()-1)),(s=this.plus)==null||s.addEventListener("click",()=>this.setQty(this.getQty()+1)),(i=this.stickyMinus)==null||i.addEventListener("click",()=>this.setQty(this.getStickyQty()-1)),(n=this.stickyPlus)==null||n.addEventListener("click",()=>this.setQty(this.getStickyQty()+1)),(e=this.form)==null||e.addEventListener("submit",this.onSubmit),(r=this.stickyBtn)==null||r.addEventListener("click",a=>{a.preventDefault(),this.onSubmit(a)}),this.syncSticky(),this.stickyEnabled&&this.setupStickyVisibility()}hideSticky(){this.sticky&&(this.sticky.classList.add("sw-translate-y-[120%]","sw-opacity-0","sw-pointer-events-none"),this.sticky.classList.remove("sw-translate-y-0","sw-opacity-100"),document.body.style.paddingBottom="")}showSticky(){this.sticky&&(this.syncSticky(),this.sticky.classList.remove("sw-translate-y-[120%]","sw-opacity-0","sw-pointer-events-none"),this.sticky.classList.add("sw-translate-y-0","sw-opacity-100"),document.body.style.paddingBottom="96px")}disconnectedCallback(){var t,s;this._stickyObserver&&this._stickyObserver.disconnect(),this._mq&&this._mqHandler&&((s=(t=this._mq).removeEventListener)==null||s.call(t,"change",this._mqHandler)),document.body.style.paddingBottom=""}getQty(){var t;return Math.max(1,parseInt(((t=this.qtyEl)==null?void 0:t.value)||"1",10)||1)}getStickyQty(){var t;return Math.max(1,parseInt(((t=this.stickyQtyEl)==null?void 0:t.value)||"1",10)||1)}setQty(t){const s=Math.max(1,parseInt(t,10)||1);this.qtyEl&&(this.qtyEl.value=String(s)),this.stickyQtyEl&&(this.stickyQtyEl.value=String(s)),this.syncSticky()}setLoading(t){var n,e;const s=((n=this.btn)==null?void 0:n.dataset.label)||"Buy Now",i=((e=this.stickyBtn)==null?void 0:e.dataset.label)||"Buy Now";this.btn&&(this.btn.disabled=t||this.btn.hasAttribute("disabled"),this.btn.textContent=t?"Adding...":s),this.stickyBtn&&(this.stickyBtn.disabled=t||this.stickyBtn.hasAttribute("disabled"),this.stickyBtn.textContent=t?"Adding...":i)}syncSticky(){var n,e,r;const t=this.getQty();this.stickyQtyEl&&(this.stickyQtyEl.value=String(t));const s=(((n=this.priceEl)==null?void 0:n.textContent)||"").trim();s&&this.stickyPrice&&(this.stickyPrice.textContent=s);const i=((e=this.btn)==null?void 0:e.disabled)||((r=this.btn)==null?void 0:r.hasAttribute("disabled"));this.stickyBtn&&(this.stickyBtn.disabled=!!i)}setupStickyVisibility(){var i,n;if(!this.sticky)return;this._mq=window.matchMedia("(max-width: 1023px)");const t=this.form||this.btn;if(!t)return;const s=()=>{if(!this._mq.matches){this.sticky.classList.add("sw-hidden"),document.body.style.paddingBottom="";return}this._stickyObserver&&this._stickyObserver.disconnect(),this._stickyObserver=new IntersectionObserver(e=>{var a;!!((a=e==null?void 0:e[0])!=null&&a.isIntersecting)?this.hideSticky():this.showSticky()},{threshold:.2}),this._stickyObserver.observe(t)};this._mqHandler=s,s(),(n=(i=this._mq).addEventListener)==null||n.call(i,"change",this._mqHandler)}async addToCart(t,s){const i=await fetch(this.cartAddUrl,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:t,quantity:s})}),e=(i.headers.get("content-type")||"").includes("application/json")?await i.json():await i.text();if(!i.ok){const r=e&&e.description||e&&e.message||(typeof e=="string"?e:"Cart add failed");throw new Error(r)}return e}async onSubmit(t){var s;t.preventDefault();try{this.status&&(this.status.textContent=""),this.setLoading(!0);const i=Number(((s=this.variantIdEl)==null?void 0:s.value)||0),n=this.getQty();if(!i)throw new Error("Variant ID missing");await this.addToCart(i,n),this.redirect==="checkout"?window.location.href=this.checkoutUrl:this.redirect==="cart"?window.location.href="/cart":this.setLoading(!1)}catch(i){console.error("ATC error:",i),this.setLoading(!1),this.status&&(this.status.textContent=(i==null?void 0:i.message)||"Add to cart failed")}}}customElements.define("meziva-single-product-hero",c);
