import { LoadingBar } from './LoadingBar.js';
import { useExitOnCtrlC } from '../hooks/use-exit-on-ctrl-c.js';
import React, { useEffect, useState } from 'react';
import { useApp } from 'ink';
const SingleTask = ({ task, title, onComplete, noColor }) => {
    const [status, setStatus] = useState(title);
    const [isDone, setIsDone] = useState(false);
    const { exit: unmountInk } = useApp();
    useExitOnCtrlC();
    useEffect(() => {
        task(setStatus)
            .then((result) => {
            setIsDone(true);
            onComplete?.(result);
            unmountInk();
        })
            .catch((error) => {
            setIsDone(true);
            unmountInk(error);
        });
    }, [task, unmountInk, onComplete]);
    if (isDone) {
        // clear things once done
        return null;
    }
    return React.createElement(LoadingBar, { title: status.value, noColor: noColor });
};
export { SingleTask };
//# sourceMappingURL=SingleTask.js.map