{% assign p = section.settings.product %}

<div id="{{ section.settings.section-id }}">
<section
  id="meziva-single-hero-{{ section.id }}"
  class="mb-relative mb-overflow-hidden mb-py-10 md:mb-py-16"
  style="background-color: {{ section.settings.section_bg }};"
>
  <div class="mb-relative mb-max-w-7xl mb-mx-auto mb-px-4 md:mb-px-8">
    {% if p == blank %}
      <div class="mb-rounded-2xl mb-bg-white mb-border mb-border-black/10 mb-p-6">
        <p class="mb-font-semibold mb-text-[#111111]">Select a product</p>
        <p class="mb-mt-1 mb-text-sm mb-text-black/60">Theme editor → this section → Product select</p>
      </div>
    {% else %}
      {% assign v = p.selected_or_first_available_variant %}
      {% assign available = v.available %}

      <meziva-single-product-hero
        class="mb-block"
        data-cart-add-url="{{ routes.cart_add_url }}.js"
        data-checkout-url="{{ routes.checkout_url }}"
        data-sticky-enabled="{{ section.settings.enable_sticky_atc }}"
        data-redirect="{{ section.settings.redirect_after_atc }}"
      >
        <div class="mb-grid mb-grid-cols-1 xl:mb-grid-cols-12 mb-gap-6 xl:mb-gap-10 ">
          <!-- LEFT: IMAGE / SLIDER -->
          <div class="xl:mb-col-span-6">
            <div class="mb-rounded-2xl">
              {% if section.settings.enable_image_slider and p.images.size > 1 %}
                <meziva-simple-slider
                  class="mb-relative mb-block
                    mb-bg-red-white  mb-border-solid mb-border-red-50 mb-p-2 mb-border-2 mb-rounded-2xl
                    mb-shadow-sm
                  "
                  data-autoplay="{{ section.settings.slider_autoplay }}"
                  data-interval="{{ section.settings.slider_interval }}"
                  data-show-arrows="{{ section.settings.slider_show_arrows }}"
                  data-show-dots="{{ section.settings.slider_show_dots }}"
                >
                  <div
                    data-slider-track
                    class="mb-flex mb-overflow-x-auto mb-overflow-y-hidden mb-scroll-smooth mb-snap-x mb-snap-mandatory mb-overscroll-x-contain mb-no-scrollbar"
                    aria-label="Product images"
                  >
                    {% for img in p.images limit: section.settings.slider_image_limit %}
                      <div data-slider-slide class="mb-min-w-full mb-snap-start">
                        <img
                           src="{{ p.featured_image | image_url: width: 1800 }}"
                            data-zoom-src="{{ p.featured_image | image_url: width: 2400 }}"
                            data-zoom-src-low="{{ p.featured_image | image_url: width: 1200 }}"
                            alt="{{ p.title | escape }}"
                            class="mb-w-full mb-h-[340px] md:mb-h-[520px] mb-object-cover mb-cursor-zoom-in mb-rounded-xl"
                            loading="lazy"
                        >
                      </div>
                    {% endfor %}
                  </div>

                  {% if section.settings.slider_show_arrows %}
                    <button
                      type="button"
                      data-slider-prev
                      aria-label="Previous"
                      class="mb-hidden md:mb-grid mb-place-items-center mb-absolute mb-left-4 mb-top-1/2 mb--translate-y-1/2 mb-h-11 mb-w-11 mb-rounded-full mb-bg-white/90 mb-border mb-border-black/10 mb-shadow-sm"
                    >
                      ‹
                    </button>
                    <button
                      type="button"
                      data-slider-next
                      aria-label="Next"
                      class="mb-hidden md:mb-grid mb-place-items-center mb-absolute mb-right-4 mb-top-1/2 mb--translate-y-1/2 mb-h-11 mb-w-11 mb-rounded-full mb-bg-white/90 mb-border mb-border-black/10 mb-shadow-sm"
                    >
                      ›
                    </button>
                  {% endif %}

                  {% if section.settings.slider_show_dots %}
                    <div
                      data-slider-dots
                      class="mb-absolute mb-bottom-4 mb-left-1/2 mb--translate-x-1/2 mb-flex mb-gap-2"
                    ></div>
                  {% endif %}
                </meziva-simple-slider>
              {% else %}
                {% if p.featured_image %}
                  <img
                     src="{{ p.featured_image | image_url: width: 1800 }}"
                      data-zoom-src="{{ p.featured_image | image_url: width: 2400 }}"
                      data-zoom-src-low="{{ p.featured_image | image_url: width: 1200 }}"
                      alt="{{ p.title | escape }}"
                      class="mb-w-full mb-h-[340px] md:mb-h-[520px] mb-object-cover mb-cursor-zoom-in"
                      loading="lazy"

                  >
                {% endif %}
              {% endif %}
            </div>
          </div>

          <!-- RIGHT: PRODUCT CARD -->
          <div class="xl:mb-col-span-6">
            <div class="mb-rounded-[16px]">
              {% if section.settings.kicker != blank %}
                <div class="mb-inline-flex mb-items-center mb-gap-2 mb-rounded-2xl mb-border mb-border-black/10 mb-px-4 mb-py-2 mb-text-xs mb-text-black/70">
                  <span class="mb-h-2 mb-w-2 mb-rounded-full " style="background: {{ section.settings.accent }};"></span>
                  {{ section.settings.kicker }}
                </div>
              {% endif %}

              <h2 class="mb-mt-3 mb-text-2xl md:mb-text-3xl mb-font-semibold mb-text-mb-text">
                {{ section.settings.heading | default: p.title }}
              </h2>

             {% if section.settings.subheading != blank %}
              <div class="mb-mt-2 mb-text-sm md:mb-text-base mb-text-black/60">
                {{ section.settings.subheading }}

                <a
                  href="{{ section.settings.readmore_link }}"
                  class="mb-ml mb-inline-flex mb-items-center mb-justify-center-1  mb-gap-1 mb-text-sm mb-font-semibold hover:mb-opacity-[.9]"
                  style="color: {{ section.settings.readmore_color }};"
                >
                  <span>Read more</span>
                  <svg class="Icon Icon--arrow-right  mb-w-2 mb-h-2" role="presentation" viewBox="0 0 11 21">
                      <polyline
                        fill="none"
                        stroke="#724430"
                        points="0.5 0.5 10.5 10.5 0.5 20.5"
                        stroke-width="3"
                      />
                      </svg>  
                </a>
              </div>
            {% endif %}


              {%- assign show_reviews = section.settings.show_reviews -%}
              {%- assign rating_count = section.settings.rating_count | default: 1200 -%}

              {% if show_reviews %}
                <div class="mb-mt-4 mb-flex mb-items-center mb-gap-2">
                  <div class="mb-flex mb-items-center mb-gap-0.5">
                    {% for i in (1..5) %}
                      <span class="mb-text-[14px] mb-text-[#FF60A6] mb-leading-none">★</span>
                    {% endfor %}
                  </div>

                  <span class="mb-text-sm mb-text-black/60">{{ rating_count }}+ reviews</span>

                  <span class="mb-inline-flex mb-items-center mb-justify-center mb-h-5 mb-w-5 mb-rounded-full mb-bg-emerald-500/15 mb-text-emerald-600 mb-text-[12px]">
                    ✓
                  </span>
                </div>
              {% endif %}

              <!-- PRICE ROW -->
              <div class="mb-mt-3 mb-flex mb-items-end mb-gap-3 mb-flex-wrap">
                <span data-role="price" class="mb-text-3xl md:mb-text-4xl mb-font-semibold mb-text-[#111111] mb-leading-none">
                  {{ v.price | money }}
                </span>

                {% if v.compare_at_price > v.price %}
                  {%- assign discount_pct = v.compare_at_price
                    | minus: v.price
                    | times: 100
                    | divided_by: v.compare_at_price
                  -%}

                  <span class="mb-text-lg mb-text-black/35 mb-line-through mb-leading-none">
                    {{ v.compare_at_price | money }}
                  </span>

                  <span class="mb-inline-flex mb-items-center mb-rounded-full mb-bg-[#FF60A6]/10 mb-text-[#FF60A6] mb-text-sm mb-font-semibold mb-px-2.5 mb-py-1 mb-leading-none">
                    -{{ discount_pct }}%
                  </span>
                {% endif %}
              </div>

              <!-- Badges -->
              {% assign solve_title = section.settings.solve_title | default: 'Made to solve' %}
              {% if section.blocks.size > 0 %}
                <div class="mb-mt-4 mb-rounded-2xl mb-p-4">
                  <p class="mb-text-sm mb-font-semibold mb-text-[#111111]">{{ solve_title }}</p>

                  <div class="mb-mt-3 mb-flex mb-flex-wrap mb-gap-x-6 mb-gap-y-3">
                    {% for block in section.blocks %}
                      {% if block.type == 'solve_item' %}
                        <div class="mb-inline-flex mb-items-center mb-gap-2">
                          {% if block.settings.icon != blank %}
                            <img
                              src="{{ block.settings.icon | image_url: width: 64 }}"
                              alt=""
                              class="mb-h-5 mb-w-5 mb-object-contain"
                              loading="lazy"
                            >
                          {% else %}
                            <span class="mb-h-5 mb-w-5 mb-rounded-full mb-bg-black/10"></span>
                          {% endif %}

                          <span class="mb-text-sm mb-text-black/70">{{ block.settings.text }}</span>
                        </div>
                      {% endif %}
                    {% endfor %}
                  </div>
                </div>
              {% endif %}

              <!-- ATC -->
              <form data-role="atc-form" class="mb-mt-6">
                <input type="hidden" data-role="variant-id" value="{{ v.id }}">
                <div class="mb-flex mb-items-center mb-gap-3">
                  <div class="mb-flex mb-items-center mb-justify-between mb-rounded-2xl mb-bg-white mb-border mb-border-black/10 mb-w-[160px] mb-h-12 mb-px-3">
                    <button type="button" data-role="qty-minus" class="mb-text-xl mb-text-black/60">–</button>
                    <input
                      data-role="qty"
                      value="1"
                      inputmode="numeric"
                      class="mb-w-10 mb-text-center mb-bg-transparent mb-outline-none mb-text-sm mb-font-medium mb-text-[#111111]"
                    >
                    <button type="button" data-role="qty-plus" class="mb-text-xl mb-text-black/60">+</button>
                  </div>

                  <button
                    type="submit"
                    data-role="atc-btn"
                    data-label="{{ section.settings.cta_label }}"
                    class="mb-flex-1 mb-h-12 mb-rounded-2xl mb-text-white mb-font-semibold mb-text-sm mb-shadow-sm"
                    style="background: {{ section.settings.accent }};"
                    {% unless available %}disabled{% endunless %}
                  >
                    {{ section.settings.cta_label }}
                  </button>
                </div>

                <p data-role="status" class="mb-mt-3 mb-text-xs mb-text-red-600"></p>
              </form>

              {% assign t1 = section.settings.trust_1 | default: 'Free Shipping' %}
              {% assign t2 = section.settings.trust_2 | default: 'Easy Returns' %}
              {% assign t3 = section.settings.trust_3 | default: 'COD Available' %}

              <div class="mb-mt-4 mb-rounded-2xl mb-bg-white/70 mb-border mb-border-black/10 mb-px-4 mb-py-3">
                <div class="mb-flex mb-flex-wrap mb-items-center mb-gap-x-6 mb-gap-y-3">
                  <div class="mb-inline-flex mb-items-center mb-gap-2">
                    <span class="mb-grid mb-place-items-center mb-h-8 mb-w-8 mb-rounded-full mb-bg-black/5 mb-border mb-border-black/10">
                      <svg viewBox="0 0 24 24" class="mb-h-4 mb-w-4 mb-text-black/70" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 7h11v10H3z"></path>
                        <path d="M14 10h4l3 3v4h-7z"></path>
                        <circle cx="7" cy="19" r="1.5"></circle>
                        <circle cx="17" cy="19" r="1.5"></circle>
                      </svg>
                    </span>
                    <span class="mb-text-sm mb-text-black/70">{{ t1 }}</span>
                  </div>

                  <div class="mb-inline-flex mb-items-center mb-gap-2">
                    <span class="mb-grid mb-place-items-center mb-h-8 mb-w-8 mb-rounded-full mb-bg-black/5 mb-border mb-border-black/10">
                      <svg viewBox="0 0 24 24" class="mb-h-4 mb-w-4 mb-text-black/70" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 12a9 9 0 1 0 3-6.7"></path>
                        <path d="M3 4v6h6"></path>
                      </svg>
                    </span>
                    <span class="mb-text-sm mb-text-black/70">{{ t2 }}</span>
                  </div>

                  <div class="mb-inline-flex mb-items-center mb-gap-2">
                    <span class="mb-grid mb-place-items-center mb-h-8 mb-w-8 mb-rounded-full mb-bg-black/5 mb-border mb-border-black/10">
                      <svg viewBox="0 0 24 24" class="mb-h-4 mb-w-4 mb-text-black/70" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 7h18v10H3z"></path>
                        <path d="M16 12h3"></path>
                      </svg>
                    </span>
                    <span class="mb-text-sm mb-text-black/70">{{ t3 }}</span>
                  </div>
                </div>
              </div>

              {% if section.settings.show_payments %}
                <div class="mb-mt-5 mb-rounded-2xl mb-border mb-border-black/10 mb-bg-white mb-p-4">
                  <p class="mb-text-xs mb-font-semibold mb-text-black/70">{{ section.settings.payment_title }}</p>
                  <div class="mb-mt-3 mb-flex mb-flex-wrap mb-gap-2 mb-items-center">
                    {% for type in shop.enabled_payment_types %}
                      {{ type | payment_type_svg_tag: class: 'mb-h-7 mb-w-auto' }}
                    {% endfor %}
                  </div>
                </div>
              {% endif %}

              <!-- MOBILE STICKY ATC -->
              <div
                data-role="sticky-atc"
                class="
                  mb-fixed mb-left-0 mb-right-0 mb-bottom-0 mb-z-[999]
                  mb-bg-white mb-border-t mb-border-black/10
                  mb-shadow-[0_-12px_30px_rgba(0,0,0,0.10)]
                  mb-px-4 mb-pt-3 mb-pb-[calc(12px+env(safe-area-inset-bottom))]
                  mb-transition mb-duration-300 mb-ease-out
                  mb-translate-y-[120%] mb-opacity-0 mb-pointer-events-none
                "
              >
                <div class="mb-flex mb-items-center mb-gap-3">
                  <div class="mb-flex-1 mb-min-w-0">
                    <div class="mb-text-[11px] mb-text-black/50 mb-leading-none">Total</div>
                    <div data-role="sticky-price" class="mb-mt-1 mb-text-[16px] mb-font-semibold mb-text-[#111111] mb-leading-tight">
                      {{ v.price | money }}
                    </div>
                  </div>

                  <div class="mb-flex mb-items-center mb-justify-between mb-rounded-2xl mb-bg-white mb-border mb-border-black/10 mb-w-[132px] mb-h-11 mb-px-3">
                    <button type="button" data-role="sticky-qty-minus" class="mb-text-xl mb-text-black/60">–</button>
                    <input
                      data-role="sticky-qty"
                      value="1"
                      inputmode="numeric"
                      class="mb-w-10 mb-text-center mb-bg-transparent mb-outline-none mb-text-sm mb-font-medium mb-text-[#111111]"
                    >
                    <button type="button" data-role="sticky-qty-plus" class="mb-text-xl mb-text-black/60">+</button>
                  </div>

                  <button
                    type="button"
                    data-role="sticky-atc-btn"
                    data-label="{{ section.settings.cta_label }}"
                    class="mb-h-11 mb-rounded-2xl mb-px-5 mb-text-white mb-font-semibold mb-text-sm mb-shadow-sm"
                    style="background: {{ section.settings.accent }};"
                    {% unless available %}disabled{% endunless %}
                  >
                    {{ section.settings.cta_label }}
                  </button>
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- ZOOM LIGHTBOX + SLIDER + SMOOTH ANIMATION (mb- only) -->
        <div
          id="mb-zoom-overlay-{{ section.id }}"
          class="
            mb-fixed mb-inset-0 mb-z-[99999] mb-flex mb-items-center mb-justify-center
            mb-bg-black/70 mb-backdrop-blur-[6px] mb-p-4
            mb-opacity-0 mb-pointer-events-none
            mb-transition mb-duration-200 mb-ease-out
          "
          aria-hidden="true"
        >
          <div
            data-lb-panel
            class="
              mb-relative mb-w-full mb-max-w-[1100px] mb-h-[78vh]
              mb-rounded-[18px] mb-overflow-hidden mb-border mb-border-white/20 mb-bg-white/5
              mb-scale-[0.98] mb-opacity-0
              mb-transition mb-duration-200 mb-ease-out
            "
          >
            <!-- Top toolbar -->
            <div class="mb-absolute mb-right-3 mb-top-3 mb-z-[3] mb-flex mb-gap-2">
              {% comment %} <button type="button" data-zoom-out class="mb-h-10 mb-w-10 mb-rounded-xl mb-border mb-border-white/20 mb-bg-black/35 mb-text-white mb-grid mb-place-items-center" aria-label="Zoom out">
                      
              </button>
              <button type="button" data-zoom-in class="mb-h-10 mb-w-10 mb-rounded-xl mb-border mb-border-white/20 mb-bg-black/35 mb-text-white mb-grid mb-place-items-center" aria-label="Zoom in">
                      
              </button>
              <button type="button" data-zoom-reset class="mb-h-10 mb-w-10 mb-rounded-xl mb-border mb-border-white/20 mb-bg-black/35 mb-text-white mb-grid mb-place-items-center" aria-label="Reset">
                      
              </button> {% endcomment %}
        
              <button type="button" data-zoom-close  class="mb-grid mb-place-items-center mb-h-7 mb-w-7 mb-rounded-full mb-bg-[#FFF6FA] mb-border mb-border-black/5 mb-transition group-hover:mb-bg-white" aria-label="Close">
                {% render 'icons-v2', icon:'icon-cross',class:"mb-fill-[#724430] mb-w-[14px] mb-h-[14px]" %}
                </button>

              
            </div>

            <!-- Slider arrows -->
            <button
              type="button"
              data-lb-prev
              aria-label="Previous"
              class="mb-hidden md:mb-grid mb-place-items-center mb-absolute mb-left-3 mb-top-1/2 mb--translate-y-1/2 mb-z-[3] mb-h-11 mb-w-11 mb-rounded-full"
            >
                     <svg class="Icon Icon--arrow-left mb-w-5 mb-h-5" role="presentation" viewBox="0 0 11 21">
                      <polyline fill="none" stroke="#724430" points="10.5 0.5 0.5 10.5 10.5 20.5" stroke-width="1.25"></polyline>
                    </svg>
            </button>
 
            <button
              type="button"
              data-lb-next
              aria-label="Next"
              class="mb-hidden md:mb-grid mb-place-items-center mb-absolute mb-right-3 mb-top-1/2 mb--translate-y-1/2 mb-z-[3] mb-h-11 mb-w-11 mb-rounded-full"
            >
                    <svg class="Icon Icon--arrow-right  mb-w-5 mb-h-5" role="presentation" viewBox="0 0 11 21">
                      <polyline
                        fill="none"
                        stroke="#724430"
                        points="0.5 0.5 10.5 10.5 0.5 20.5"
                        stroke-width="1.6"
                      />
                      </svg>  
            </button>

            <!-- Track (slides injected by JS) -->
            <div
              data-lb-track
              class="mb-h-full mb-w-full mb-flex mb-overflow-x-auto mb-overflow-y-hidden mb-scroll-smooth mb-snap-x mb-snap-mandatory mb-overscroll-x-contain mb-no-scrollbar"
              aria-label="Zoomed product images"
            ></div>
           
          </div>
        </div>

      </meziva-single-product-hero>
    {% endif %}
  </div>
</section>
</div>

<style>
  .mb-no-scrollbar { scrollbar-width: none; }
  .mb-no-scrollbar::-webkit-scrollbar { display: none; }
</style>

{% schema %}
{
  "name": "Single Product Hero",
  "settings": [
    { "type": "text", "id": "section-id", "label": "Section ID", "info": "#banner" },
    { "type": "color", "id": "section_bg", "label": "Section BG"},
    { "type": "product", "id": "product", "label": "Product (Home page)" },

    { "type": "text", "id": "kicker", "label": "Kicker", "default": "CLEAN • HYDRATING • TINTED" },
    { "type": "text", "id": "heading", "label": "Heading (optional)" },

    { "type": "checkbox", "id": "show_reviews", "label": "Show reviews widget", "default": true },
    {
      "type": "range",
      "id": "rating_value",
      "label": "Rating (display only)",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 5
    },
    { "type": "number", "id": "rating_count", "label": "Reviews count (display only)", "default": 1200 },

    {
      "type": "richtext",
      "id": "subheading",
      "label": "Subheading",
      "default": "<p>Skincare-first lip balm with hydration + tint in 1 swipe. Lightweight, non-sticky feel.</p>"
    },
    {
      "type": "url",
      "id": "readmore_link",
      "label": "Read more link",
      "info": "Redirect user to product detail / about page"
        },
    {
      "type": "color",
      "id": "readmore_color",
      "label": "Read more color",
      "default": "#724430"
    },
    { "type": "text", "id": "cta_label", "label": "CTA label", "default": "Buy Now" },
    { "type": "text", "id": "price_note", "label": "Price note", "default": "Inclusive of all taxes" },

    { "type": "text", "id": "trust_1", "label": "Trust 1", "default": "Free Shipping" },
    { "type": "text", "id": "trust_2", "label": "Trust 2", "default": "Easy Returns" },
    { "type": "text", "id": "trust_3", "label": "Trust 3", "default": "COD Available" },

    { "type": "color", "id": "accent", "label": "Accent", "default": "#FF60A6" },

    { "type": "checkbox", "id": "enable_sticky_atc", "label": "Enable mobile sticky ATC", "default": true },
    {
      "type": "select",
      "id": "redirect_after_atc",
      "label": "After Add to cart",
      "default": "checkout",
      "options": [
        { "value": "checkout", "label": "Go to checkout" },
        { "value": "cart", "label": "Go to cart" },
        { "value": "none", "label": "Stay on page" }
      ]
    },

    { "type": "checkbox", "id": "enable_image_slider", "label": "Enable image slider", "default": true },
    {
      "type": "range",
      "id": "slider_image_limit",
      "label": "Max images in slider",
      "min": 1,
      "max": 10,
      "step": 1,
      "default": 6
    },
    { "type": "checkbox", "id": "slider_show_arrows", "label": "Show arrows", "default": true },
    { "type": "checkbox", "id": "slider_show_dots", "label": "Show dots", "default": true },
    { "type": "checkbox", "id": "slider_autoplay", "label": "Autoplay slider", "default": true },
    {
      "type": "range",
      "id": "slider_interval",
      "label": "Autoplay interval (seconds)",
      "min": 2,
      "max": 10,
      "step": 1,
      "default": 4
    },

    { "type": "text", "id": "solve_title", "label": "Solve section title", "default": "Made to solve" },

    { "type": "checkbox", "id": "show_payments", "label": "Show payment icons", "default": false },
    { "type": "text", "id": "payment_title", "label": "Payment title", "default": "Secure Checkout" }
  ],
  "blocks": [
    {
      "type": "solve_item",
      "name": "Solve item",
      "settings": [
        { "type": "image_picker", "id": "icon", "label": "Icon (PNG/SVG)" },
        { "type": "text", "id": "text", "label": "Label", "default": "Dryness" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Single Product Hero",
      "blocks": [
        { "type": "solve_item", "settings": { "text": "Dryness" } },
        { "type": "solve_item", "settings": { "text": "Chapping" } },
        { "type": "solve_item", "settings": { "text": "Pigmentation" } }
      ]
    }
  ]
}
{% endschema %}

{% render 'vite-tag' with 'meziva-home-hero.js' %}
