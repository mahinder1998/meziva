{"version":3,"file":"SingleTask.test.js","sourceRoot":"","sources":["../../../../../src/private/node/ui/components/SingleTask.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import {SingleTask} from './SingleTask.js'\nimport {render} from '../../testing/ui.js'\nimport {TokenizedString} from '../../../../public/node/output.js'\nimport React from 'react'\nimport {describe, expect, test} from 'vitest'\n\ndescribe('SingleTask', () => {\n  test('unmounts when promise resolves successfully', async () => {\n    // Given\n    const title = new TokenizedString('Uploading files')\n    let resolvePromise: (value: string) => void\n    const task = () =>\n      new Promise<string>((resolve) => {\n        resolvePromise = resolve\n      })\n\n    // When\n    const renderInstance = render(<SingleTask title={title} task={task} />)\n\n    // Wait for initial render\n    await new Promise((resolve) => setTimeout(resolve, 10))\n\n    // Resolve the promise\n    resolvePromise!('success')\n\n    // Wait for component to update and unmount\n    await renderInstance.waitUntilExit()\n\n    // Then - component should unmount cleanly\n    expect(renderInstance.lastFrame()).toBeDefined()\n  })\n\n  test('unmounts when promise rejects', async () => {\n    // Given\n    const title = new TokenizedString('Failed task')\n    let rejectPromise: (error: Error) => void\n    const task = () =>\n      new Promise<string>((resolve, reject) => {\n        rejectPromise = reject\n      })\n\n    // When\n    const renderInstance = render(<SingleTask title={title} task={task} />)\n\n    // Wait for initial render\n    await new Promise((resolve) => setTimeout(resolve, 10))\n\n    // Reject the promise and expect waitUntilExit to reject\n    rejectPromise!(new Error('Task failed'))\n\n    // The component should exit with the error\n    await expect(renderInstance.waitUntilExit()).rejects.toThrow('Task failed')\n  })\n\n  test('handles promise that resolves immediately', async () => {\n    // Given\n    const title = new TokenizedString('Instant task')\n    const task = () => Promise.resolve('immediate success')\n\n    // When\n    const renderInstance = render(<SingleTask title={title} task={task} />)\n    await renderInstance.waitUntilExit()\n\n    // Then - component should complete successfully\n    expect(renderInstance.lastFrame()).toBeDefined()\n  })\n\n  test('handles promise that rejects immediately', async () => {\n    // Given\n    const title = new TokenizedString('Instant failure')\n    const task = () => Promise.reject(new Error('Immediate error'))\n\n    // When\n    const renderInstance = render(<SingleTask title={title} task={task} />)\n\n    // Then - should exit with error\n    await expect(renderInstance.waitUntilExit()).rejects.toThrow('Immediate error')\n  })\n\n  test('handles different types of promise return values', async () => {\n    // Test with string\n    let stringResult: string | undefined\n    const stringTask = () => Promise.resolve('task completed')\n    const stringRender = render(\n      <SingleTask\n        title={new TokenizedString('String task')}\n        task={stringTask}\n        onComplete={(result) => (stringResult = result)}\n      />,\n    )\n    await stringRender.waitUntilExit()\n    expect(stringRender.lastFrame()).toBeDefined()\n    expect(stringResult).toBe('task completed')\n\n    // Test with object\n    let objectResult: {id: number; name: string} | undefined\n    const objectTask = () => Promise.resolve({id: 1, name: 'test'})\n    const objectRender = render(\n      <SingleTask\n        title={new TokenizedString('Object task')}\n        task={objectTask}\n        onComplete={(result) => (objectResult = result)}\n      />,\n    )\n    await objectRender.waitUntilExit()\n    expect(objectRender.lastFrame()).toBeDefined()\n\n    // Test with number\n    let numberResult: number | undefined\n    const numberTask = () => Promise.resolve(42)\n    const numberRender = render(\n      <SingleTask\n        title={new TokenizedString('Number task')}\n        task={numberTask}\n        onComplete={(result) => (numberResult = result)}\n      />,\n    )\n    await numberRender.waitUntilExit()\n    expect(numberRender.lastFrame()).toBeDefined()\n    expect(numberResult).toBe(42)\n\n    // Test with boolean\n    let booleanResult: boolean | undefined\n    const booleanTask = () => Promise.resolve(true)\n    const booleanRender = render(\n      <SingleTask\n        title={new TokenizedString('Boolean task')}\n        task={booleanTask}\n        onComplete={(result) => (booleanResult = result)}\n      />,\n    )\n    await booleanRender.waitUntilExit()\n    expect(booleanRender.lastFrame()).toBeDefined()\n    expect(booleanResult).toBe(true)\n  })\n\n  test('handles promise with delayed resolution', async () => {\n    // Given\n    const title = new TokenizedString('Delayed task')\n    const task = () =>\n      new Promise<string>((resolve) => {\n        setTimeout(() => resolve('completed'), 100)\n      })\n\n    // When\n    const renderInstance = render(<SingleTask title={title} task={task} />)\n\n    // Wait for completion\n    await renderInstance.waitUntilExit()\n\n    // Then\n    expect(renderInstance.lastFrame()).toBeDefined()\n  })\n\n  test('handles promise with delayed rejection', async () => {\n    // Given\n    const title = new TokenizedString('Delayed failure')\n    const task = () =>\n      new Promise<string>((resolve, reject) => {\n        setTimeout(() => reject(new Error('delayed error')), 100)\n      })\n\n    // When\n    const renderInstance = render(<SingleTask title={title} task={task} />)\n\n    // Wait for completion - should throw error\n    await expect(renderInstance.waitUntilExit()).rejects.toThrow('delayed error')\n  })\n\n  test('preserves error types and messages', async () => {\n    // Test with custom error\n    class CustomError extends Error {\n      constructor(message: string, public code: string) {\n        super(message)\n        this.name = 'CustomError'\n      }\n    }\n\n    const customError = new CustomError('Custom error message', 'CUSTOM_CODE')\n    const task = () => Promise.reject(customError)\n\n    // When\n    const renderInstance = render(<SingleTask title={new TokenizedString('Custom error task')} task={task} />)\n\n    // Then - should preserve the exact error\n    await expect(renderInstance.waitUntilExit()).rejects.toThrow('Custom error message')\n  })\n\n  test('handles concurrent promise operations', async () => {\n    // Given - Multiple SingleTask components with different promises\n    const fastPromise = () => new Promise((resolve) => setTimeout(() => resolve('fast'), 50))\n    const slowPromise = () => new Promise((resolve) => setTimeout(() => resolve('slow'), 150))\n\n    // When\n    const fastRender = render(<SingleTask title={new TokenizedString('Fast task')} task={fastPromise} />)\n    const slowRender = render(<SingleTask title={new TokenizedString('Slow task')} task={slowPromise} />)\n\n    // Then - Both should complete successfully\n    await fastRender.waitUntilExit()\n    await slowRender.waitUntilExit()\n\n    expect(fastRender.lastFrame()).toBeDefined()\n    expect(slowRender.lastFrame()).toBeDefined()\n  })\n\n  test('passes noColor prop to LoadingBar component', async () => {\n    // Given\n    const title = new TokenizedString('No color task')\n    const task = () => Promise.resolve()\n\n    // When - Test that noColor prop doesn't break the component\n    const renderInstance = render(<SingleTask title={title} task={task} noColor />)\n    await renderInstance.waitUntilExit()\n\n    // Then - Component should complete successfully with noColor prop\n    expect(renderInstance.lastFrame()).toBeDefined()\n  })\n\n  test('updates status message during task execution', async () => {\n    // Given\n    const initialTitle = new TokenizedString('Starting task')\n    let step1Resolve: () => void\n    let step2Resolve: () => void\n    let step3Resolve: () => void\n\n    const step1Promise = new Promise<void>((resolve) => {\n      step1Resolve = resolve\n    })\n    const step2Promise = new Promise<void>((resolve) => {\n      step2Resolve = resolve\n    })\n    const step3Promise = new Promise<void>((resolve) => {\n      step3Resolve = resolve\n    })\n\n    const task = async (updateStatus: (status: TokenizedString) => void) => {\n      updateStatus(new TokenizedString('Running (1 complete)...'))\n      await step1Promise\n\n      updateStatus(new TokenizedString('Running (2 complete)...'))\n      await step2Promise\n\n      updateStatus(new TokenizedString('Running (3 complete)...'))\n      await step3Promise\n\n      return 'completed'\n    }\n\n    // When\n    const renderInstance = render(<SingleTask title={initialTitle} task={task} />)\n\n    // Wait for component to render with first status\n    await new Promise((resolve) => setTimeout(resolve, 10))\n    const frame1 = renderInstance.lastFrame()\n    expect(frame1).toContain('1 complete')\n\n    // Progress to step 2\n    step1Resolve!()\n    await new Promise((resolve) => setTimeout(resolve, 10))\n    const frame2 = renderInstance.lastFrame()\n    expect(frame2).toContain('2 complete')\n\n    // Progress to step 3\n    step2Resolve!()\n    await new Promise((resolve) => setTimeout(resolve, 10))\n    const frame3 = renderInstance.lastFrame()\n    expect(frame3).toContain('3 complete')\n\n    // Complete the task\n    step3Resolve!()\n    await renderInstance.waitUntilExit()\n  })\n})\n"]}