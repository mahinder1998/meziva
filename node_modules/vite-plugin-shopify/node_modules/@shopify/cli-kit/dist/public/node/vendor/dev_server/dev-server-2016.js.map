{"version":3,"file":"dev-server-2016.js","sourceRoot":"","sources":["../../../../../src/public/node/vendor/dev_server/dev-server-2016.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,MAAM,IAAI,CAAA;AACnB,OAAO,KAAK,EAAE,MAAM,SAAS,CAAA;AAE7B,OAAO,EAAC,iBAAiB,EAAC,MAAM,oBAAoB,CAAA;AACpD,OAAO,EAAC,2BAA2B,EAAC,MAAM,UAAU,CAAA;AAGpD,MAAM,UAAU,YAAY,CAAC,WAAmB;IAC9C,OAAO;QACL,IAAI,EAAE,CAAC,UAAuB,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC;QAC/D,GAAG,EAAE,CAAC,UAAuB,EAAE,EAAE,EAAE,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC;KAC9D,CAAA;AACH,CAAC;AAED,SAAS,IAAI,CAAC,WAAmB,EAAE,UAAuB,EAAE;IAC1D,2BAA2B,EAAE,CAC5B;IAAA,CAAC,qBAAqB,IAAI,iBAAiB,CAAC,CAAC,WAAW,CAAC,CAAA;IAE1D,MAAM,MAAM,GAAG,OAAO,CAAC,qBAAqB,IAAI,WAAW,CAAA;IAE3D,OAAO,GAAG,MAAM,eAAe,CAAA;AACjC,CAAC;AAED,SAAS,GAAG,CAAC,WAAmB,EAAE,UAAuB,EAAE;IACzD,OAAO,WAAW,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC,EAAE,CAAA;AAChD,CAAC;AAED,SAAS,iBAAiB,CAAC,WAAmB;IAC5C,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,WAAW,CAAC,WAAW,CAAC,CAAA;IAC7C,iBAAiB,CAAC,EAAC,WAAW,EAAE,IAAI,EAAE,IAAI,EAAC,CAAC,CAAA;AAC9C,CAAC;AAED,SAAS,WAAW,CAAC,IAAY;IAC/B,IAAI,CAAC;QACH,MAAM,WAAW,GAAG,EAAE,CAAC,YAAY,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,wBAAwB,IAAI,cAAc,EAAE,OAAO,CAAC,CAAA;QACvG,OAAO,CAAC,WAAW,EAAE,QAAQ,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC,CAAA;IACjD,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,MAAM,IAAI,KAAK,CAAC,kBAAkB,IAAI,8BAA8B,IAAI,iBAAiB,CAAC,CAAA;IAC5F,CAAC;AACH,CAAC;AAED,oDAAoD;AACpD,IAAI,qBAA2D,CAAA;AAE/D,MAAM,UAAU,gBAAgB,CAAC,QAAsC;IACrE,qBAAqB,GAAG,QAAQ,CAAA;AAClC,CAAC","sourcesContent":["import fs from 'fs'\nimport * as os from 'node:os'\n\nimport {assertConnectable} from './network/index.js'\nimport {assertCompatibleEnvironment} from './env.js'\nimport {HostOptions} from './types.js'\n\nexport function createServer(projectName: string) {\n  return {\n    host: (options: HostOptions = {}) => host(projectName, options),\n    url: (options: HostOptions = {}) => url(projectName, options),\n  }\n}\n\nfunction host(projectName: string, options: HostOptions = {}): string {\n  assertCompatibleEnvironment()\n  ;(assertRunningOverride || assertRunning2016)(projectName)\n\n  const prefix = options.nonstandardHostPrefix || projectName\n\n  return `${prefix}.myshopify.io`\n}\n\nfunction url(projectName: string, options: HostOptions = {}): string {\n  return `https://${host(projectName, options)}`\n}\n\nfunction assertRunning2016(projectName: string): void {\n  const [addr, port] = getAddrPort(projectName)\n  assertConnectable({projectName, addr, port})\n}\n\nfunction getAddrPort(name: string): [string, number] {\n  try {\n    const portContent = fs.readFileSync(`${os.homedir()}/.local/run/services/${name}/server/port`, 'utf-8')\n    return ['localhost', parseInt(portContent, 10)]\n  } catch (error) {\n    throw new Error(`DevServer for '${name}' is not running: \\`dev up ${name}\\` to start it.`)\n  }\n}\n\n// Allow overrides for more concise test setup. Meh.\nlet assertRunningOverride: typeof assertRunning2016 | undefined\n\nexport function setAssertRunning(override: typeof assertRunningOverride) {\n  assertRunningOverride = override\n}\n"]}